<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">

<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-DD4SQ88NVT"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-DD4SQ88NVT');
</script>

<title>CheckInfra ‚Äì Avalia√ß√£o Sanit√°ria</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="manifest" href="./manifest.json">
<meta name="theme-color" content="#1f4fd8">

<!-- jsPDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
body { font-family: Arial, sans-serif; background: #f4f6f8; margin: 0; }
.header { background: #1f4fd8; height: 80px; }
.logo-box { display: flex; justify-content: center; margin-top: -40px; }
.logo-box img { height: 90px; }
.container { max-width: 900px; margin: 20px auto; padding: 0 16px; }
h1 { text-align: center; margin: 20px 0; }

.card { background: #fff; border-radius: 14px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 6px rgba(0,0,0,.08); }
label { font-weight: bold; display: block; margin-bottom: 6px; }
select, input { width: 100%; padding: 10px; border-radius: 8px; border: 1px solid #ccc; margin-bottom: 14px; }

.categoria { margin-bottom: 20px; }
.categoria h3 { color: #1f4fd8; margin-bottom: 12px; }

.checklist { display: flex; flex-direction: column; gap: 12px; }
.check-card { border: 2px solid #e0e0e0; border-radius: 12px; padding: 16px; cursor: pointer; display: flex; align-items: center; gap: 12px; background: #fafafa; transition: all .2s ease; }
.check-card span.icon { font-size: 22px; }
.check-card:has(input:checked) { border-color: #1f4fd8; background: #eaf0ff; font-weight: bold; }

.upload-box { border: 2px dashed #bbb; border-radius: 14px; padding: 20px; text-align: center; background: #fcfcfc; margin-bottom: 20px; }
.upload-box input { display: none; }
.upload-preview { display: flex; gap: 10px; flex-wrap: wrap; margin-top: 12px; }
.upload-preview img { width: 100px; height: auto; border-radius: 8px; border: 1px solid #ccc; }

button { width: 100%; padding: 16px; background: #1f4fd8; color: #fff; border: none; border-radius: 12px; font-size: 16px; font-weight: bold; cursor: pointer; }
button:hover { background: #163ca6; }

.resultado { display: none; padding: 20px; border-radius: 12px; font-weight: bold; }
.resultado.ok { background: #e8f7ee; color: #1e7e34; }
.resultado.alerta { background: #fff3cd; color: #856404; }
.resultado.critico { background: #f8d7da; color: #721c24; }

.selo { display: inline-block; padding: 6px 12px; border-radius: 20px; font-size: 13px; font-weight: bold; margin-bottom: 10px; }
.selo-ok { background: #d4edda; color: #155724; }
.selo-alerta { background: #fff3cd; color: #856404; }
.selo-critico { background: #f8d7da; color: #721c24; }

#offlineCard { background: #fff8e1; color: #856404; border-left: 6px solid #f0ad4e; padding: 12px; margin-bottom: 16px; }
</style>
</head>

<body>

<div class="header"></div>

<div class="logo-box">
  <img src="./logo.png" alt="CheckInfra">
</div>

<div class="container">

<h1>Avalia√ß√£o Sanit√°ria Escolar</h1>

<!-- AVISO OFFLINE -->
<div id="offlineCard" class="card" style="display:none">
üì¥ <strong>Modo offline ativo</strong><br>
Os dados ser√£o sincronizados automaticamente quando a conex√£o voltar.
</div>

<form id="form-avaliacao">

  <!-- CARD 1 ‚Äî IDENTIFICA√á√ÉO -->
  <div class="card">
    <label>Escola</label>
    <select id="escola" required>
      <option value="">Selecione</option>
    </select>

    <label>Avaliador</label>
    <input type="text" id="avaliador" placeholder="Nome do avaliador" required>
  </div>

  <!-- CARD 2 ‚Äî CHECKLIST -->
  <div class="card">

    <div class="categoria">
      <h3>üèóÔ∏è Estrutura</h3>
      <div class="checklist">
        <label class="check-card">
          <span class="icon">ü¶†</span>
          <input type="checkbox" data-peso="3"> Mofo ou umidade
        </label>
        <label class="check-card">
          <span class="icon">üß±</span>
          <input type="checkbox" data-peso="2"> Piso danificado
        </label>
        <label class="check-card">
          <span class="icon">üíß</span>
          <input type="checkbox" data-peso="2"> Infiltra√ß√µes
        </label>
      </div>
    </div>

    <div class="categoria">
      <h3>üßπ Higiene</h3>
      <div class="checklist">
        <label class="check-card">
          <span class="icon">üßπ</span>
          <input type="checkbox" data-peso="2"> Limpeza inadequada
        </label>
        <label class="check-card">
          <span class="icon">ü¶®</span>
          <input type="checkbox" data-peso="2"> Mau cheiro persistente
        </label>
      </div>
    </div>

    <div class="categoria">
      <h3>üí° Conforto</h3>
      <div class="checklist">
        <label class="check-card">
          <span class="icon">üí°</span>
          <input type="checkbox" data-peso="1"> Ilumina√ß√£o insuficiente
        </label>
        <label class="check-card">
          <span class="icon">üå¨Ô∏è</span>
          <input type="checkbox" data-peso="1"> Ventila√ß√£o inadequada
        </label>
      </div>
    </div>

  </div>

  <!-- CARD 3 ‚Äî UPLOAD DE FOTOS -->
  <div class="card upload-box">
    <label for="fotos">
      üì∑ <strong>Anexar fotos do ambiente</strong><br>
      <small>(opcional ‚Äî n√£o substitui vistoria t√©cnica)</small>
    </label>
    <input type="file" id="fotos" accept="image/*" multiple>
    <div id="preview" class="upload-preview"></div>
  </div>

  <!-- BOT√ÉO -->
  <button type="submit">Gerar Diagn√≥stico</button>
</form>

<!-- RESULTADO -->
<div id="resultado" class="resultado"></div>
</div>

<!-- ESCOLAS -->
<script src="./mapa/escolas.js"></script>
<script>
document.addEventListener("DOMContentLoaded", () => {
  const select = document.getElementById("escola");
  if (window.escolas) {
    window.escolas.forEach(e => {
      const opt = document.createElement("option");
      opt.value = e.nome;
      opt.textContent = e.nome;
      select.appendChild(opt);
    });
  }
});
</script>

<!-- SCRIPT PRINCIPAL (avaliacao.js) -->
<script type="module" src="./js/avaliacao.js"></script>

<!-- SERVICE WORKER -->
<script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register("./service-worker.js");
}
</script>

</body>
</html>
